---
title: "Assignment7"
author: "Ingrid Jacobson"
date: "`r Sys.Date()`"
output: html_document
---

## Task One: Set-up

```{r, include = FALSE, results='hide'}
#Task 1: Set up
library(tidyverse)
library(data.table)
library(lubridate)
library(googledrive)
source("sepsis_monitor_functions.R")

```

## Task 2: Speed Reading

```{r, echo = FALSE, results = 'hide'}
library(tictoc)
source("sepsis_monitor_functions.R")

tic()
sepsis_data_50_fread <- makeSepsisDataset(n = 50, read_fn = "fread")
toc()

tic()
sepsis_data_50_delim <- makeSepsisDataset(n = 50, read_fn = "read_delim")
toc()

tic()
sepsis_data_100_fread <- makeSepsisDataset(n = 100, read_fn = "fread")
toc()

tic()
sepsis_data_100_delim <- makeSepsisDataset(n = 100, read_fn = "read_delim")
toc()

tic()
sepsis_data_500_fread <- makeSepsisDataset(n = 500, read_fn = "fread")
toc()

tic()
sepsis_data_500_delim <- makeSepsisDataset(n = 500, read_fn = "read_delim")
toc()


```

#### Timing Results:

|                | 50 patients    | 100 patients   | 500 patients    |
|----------------|----------------|----------------|-----------------|
| **fread**      | 4.502 seconds  | 9.168 seconds  | 48.911 seconds  |
| **read_delim** | 18.235 seconds | 36.397 seconds | 180.822 seconds |

### Task 3: Google Drive

```{r, results='hide'}
library(googledrive)
source("sepsis_monitor_functions.R")

library(googledrive)

# Set the path to the JSON file
json_file <- "sepsis_client_id.json"

# Authenticate with the Google Drive API using the JSON file
drive_auth(path = json_file)

# Check that authentication was successful
drive_about()

# Create the sepsis dataset
df <- makeSepsisDataset()

# Write the dataset to a temporary CSV file
write_csv(df, "sepsis_data_temp.csv")

# Upload the file to the specified folder
sepsis_file <- drive_upload(
  "sepsis_data_temp.csv",
  path = "1qTts4tUO6ExMNQ9-ujCZMU0H5ChKt9RJ",
  type = "text/csv"
)

# Set the file permissions so anyone can download this file
drive_share_anyone(sepsis_file)
```

```{r, results='hide'}
sepsis_file <- drive_upload(media = "sepsis_data_temp.csv",
                            name = "sepsis_data.csv",
                            type = "text/csv",
                            path = "sepsis_data_folder")

```

